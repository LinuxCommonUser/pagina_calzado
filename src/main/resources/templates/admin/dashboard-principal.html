<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Dashboard Principal</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        body{ background:#f4f6f9; }
        .sidebar{ background:#212529; min-height:100vh; }
        .sidebar a{
            color:white;
            display:block;
            padding:12px;
            text-decoration:none;
        }
        .sidebar a:hover{ background:#0d6efd; }
    </style>
</head>

<body>

<div class="container-fluid">
<div class="row">

    <!-- SIDEBAR -->
    <div class="col-md-2 sidebar p-0">
        <h4 class="text-center text-white py-3">ADMIN PANEL</h4>

        <a th:href="@{/admin/dashboard}">Dashboard</a>
        <a th:href="@{/admin/usuarios}">Usuarios</a>
        <a th:href="@{/admin/productos}">Productos</a>
        <a th:href="@{/admin/ventas}">Ventas</a>
    </div>

    <!-- CONTENIDO -->
    <div class="col-md-10 p-4">

        <h2 class="mb-4">Dashboard General</h2>

        <!-- CARDS RESUMEN -->
        <div class="row mb-4">
            <div class="col-md-3">
                <div class="card shadow">
                    <div class="card-body">
                        <h6>Usuarios</h6>
                        <h3 th:text="${totalUsuarios}"></h3>
                    </div>
                </div>
            </div>

            <div class="col-md-3">
                <div class="card shadow">
                    <div class="card-body">
                        <h6>Productos</h6>
                        <h3 th:text="${totalProductos}"></h3>
                    </div>
                </div>
            </div>

            <div class="col-md-3">
                <div class="card shadow">
                    <div class="card-body">
                        <h6>Ventas</h6>
                        <h3 th:text="${totalVentas}"></h3>
                    </div>
                </div>
            </div>
        </div>

        <!-- GRÁFICOS -->
        <div class="row">

            <!-- GRÁFICO PASTEL USUARIOS -->
            <div class="col-md-6">
                <div class="card shadow">
                    <div class="card-header bg-dark text-white">
                        Distribución de Usuarios
                    </div>
                    <div class="card-body">
                        <canvas id="usuariosChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- GRÁFICO VENTAS POR DÍA -->
            <div class="col-md-6">
                <div class="card shadow">
                    <div class="card-header bg-dark text-white">
                        Ventas por Día
                    </div>
                    <div class="card-body">
                        <canvas id="ventasChart"></canvas>
                    </div>
                </div>
            </div>

        </div>

    </div>
</div>
</div>

<script th:inline="javascript">
/*<![CDATA[*/

let totalAdmins = /*[[${totalAdmins}]]*/ 0;
let totalClientes = /*[[${totalClientes}]]*/ 0;
let totalVendedores = /*[[${totalVendedores}]]*/ 0;

let fechas = /*[[${fechas}]]*/ [];
let montos = /*[[${montos}]]*/ [];

new Chart(document.getElementById('usuariosChart'), {
    type: 'pie',
    data: {
        labels: ['Admins', 'Clientes', 'Vendedores'],
        datasets: [{
            data: [totalAdmins, totalClientes, totalVendedores],
            backgroundColor: ['#198754', '#0d6efd', '#ffc107']
        }]
    }
});

new Chart(document.getElementById('ventasChart'), {
    type: 'line',
    data: {
        labels: fechas,
        datasets: [{
            label: 'Ventas (S/)',
            data: montos,
            borderColor: '#0d6efd',
            fill: false,
            tension: 0.3
        }]
    }
});

/*]]>*/
</script>


</body>
</html>
